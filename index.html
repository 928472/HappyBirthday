<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no" />
    <title>å°è¯ - ç”Ÿæ—¥å¿«ä¹</title>

    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>

    <link href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@700&family=Noto+Serif+SC:wght@500;700&display=swap" rel="stylesheet">

    <style>
        :root { --pink-glow: #ff69b4; }

        body {
            margin: 0;
            overflow: hidden;
            background: #000;
            font-family: 'Noto Serif SC', serif;
            color: #fff;
        }

        #canvas-container {
            position: fixed;
            inset: 0;
            z-index: 1;
        }

        .glass-panel {
            background: rgba(0, 0, 0, 0.6);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 2rem;
            box-shadow: 0 0 40px rgba(0, 0, 0, 0.5);
        }

        .neon-text {
            text-shadow: 0 0 20px var(--pink-glow), 0 0 40px rgba(255, 105, 180, 0.3);
        }

        .font-handwriting {
            font-family: 'Dancing Script', cursive;
        }

        #start-overlay {
            position: fixed;
            inset: 0;
            z-index: 9999;
            display: flex;
            align-items: center;
            justify-content: center;
            background: radial-gradient(circle, #1a1a1a 0%, #000 100%);
            transition: opacity 1s ease;
        }

        #main-ui {
            position: fixed;
            inset: 0;
            z-index: 10;
            pointer-events: none;
        }

        .hidden {
            display: none !important;
        }

        .typewriter-cursor::after {
            content: '|';
            animation: blink 1s infinite;
        }

        @keyframes blink {
            0%, 100% { opacity: 1; }
            50% { opacity: 0; }
        }
    </style>
</head>

<body>
<audio id="bgm" loop>
    <source src="./src/happy-birthday-155461.mp3" type="audio/mpeg" />
</audio>

<div id="canvas-container"></div>

<div id="start-overlay">
    <div class="glass-panel p-12 text-center mx-4 border-pink-500/20">
        <h1 class="text-4xl mb-2 font-handwriting text-pink-400">Special Moment</h1>
        <h2 class="text-7xl mb-12 font-bold tracking-tighter neon-text">å°è¯</h2>
        <button
            id="start-btn"
            class="px-16 py-4 bg-white text-black rounded-full font-bold text-xl hover:bg-pink-400 hover:text-white transition-all duration-500 shadow-2xl"
            style="pointer-events:auto"
        >
            å¼€å¯âœ¨
        </button>
    </div>
</div>

<div id="main-ui" class="flex items-center justify-center opacity-0 transition-opacity duration-1000 px-8">
    <div class="glass-panel p-10 max-w-lg w-full text-center border-white/5">
        <div class="text-5xl mb-8">ğŸ‚</div>
        <p
            id="blessing"
            class="text-2xl leading-relaxed text-gray-100 font-light tracking-wide min-h-[150px] typewriter-cursor"
        ></p>
        <div class="mt-10 pt-6 border-t border-white/10 text-xl font-handwriting text-pink-300 opacity-80">
            Happy Birthday, Xiaodan.
        </div>
    </div>
</div>

<script>
/* =======================
   å¸¸é‡ä¸ DOM å¼•ç”¨
======================= */
const TEXT =
    "å²åºæ›´æ›¿ï¼Œåç« æ—¥æ–°ã€‚æ„¿ä½ æœ‰ç›´é¢æ¸…æ™¨æ—¥å…‰çš„çƒ­å¿±ï¼Œäº¦æœ‰æ¼«æ­¥é»„æ˜ä½™æ™–çš„ä»å®¹ã€‚æ‰€æœ‰çš„ç¾å¥½éƒ½â€œè¯â€ç”Ÿäºæ­¤ï¼Œç¥ä½ ç”Ÿæ—¥å¿«ä¹ã€‚âœ¨";

const dom = {
    startBtn: document.getElementById('start-btn'),
    startOverlay: document.getElementById('start-overlay'),
    mainUI: document.getElementById('main-ui'),
    blessing: document.getElementById('blessing'),
    bgm: document.getElementById('bgm'),
    canvasContainer: document.getElementById('canvas-container')
};

/* =======================
   Three.js èƒŒæ™¯
======================= */
let scene, camera, renderer, points;

function initThree() {
    scene = new THREE.Scene();

    camera = new THREE.PerspectiveCamera(
        75,
        window.innerWidth / window.innerHeight,
        0.1,
        2000
    );
    camera.position.z = 1000;

    renderer = new THREE.WebGLRenderer({ antialias: true, alpha: true });
    renderer.setSize(window.innerWidth, window.innerHeight);
    renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));
    dom.canvasContainer.appendChild(renderer.domElement);

    const geometry = new THREE.BufferGeometry();
    const vertices = [];

    for (let i = 0; i < 8000; i++) {
        vertices.push(
            THREE.MathUtils.randFloatSpread(2000),
            THREE.MathUtils.randFloatSpread(2000),
            THREE.MathUtils.randFloatSpread(2000)
        );
    }

    geometry.setAttribute(
        'position',
        new THREE.Float32BufferAttribute(vertices, 3)
    );

    const material = new THREE.PointsMaterial({
        color: 0xff69b4,
        size: 2,
        transparent: true,
        opacity: 0.6
    });

    points = new THREE.Points(geometry, material);
    scene.add(points);

    animate();
}

function animate() {
    requestAnimationFrame(animate);
    points.rotation.y += 0.001;
    points.rotation.x += 0.0005;
    renderer.render(scene, camera);
}

function onResize() {
    camera.aspect = window.innerWidth / window.innerHeight;
    camera.updateProjectionMatrix();
    renderer.setSize(window.innerWidth, window.innerHeight);
}

/* =======================
   æ‰“å­—æœºæ•ˆæœ
======================= */
function typeWriter(text, el, speed = 60) {
    let index = 0;
    el.innerHTML = '';

    function tick() {
        if (index < text.length) {
            el.innerHTML += text.charAt(index++);
            setTimeout(tick, speed);
        }
    }

    tick();
}

/* =======================
   UI äº¤äº’
======================= */
let started = false;

dom.startBtn.addEventListener('click', () => {
    if (started) return;
    started = true;

    dom.bgm.play().catch(() => {});
    dom.startOverlay.style.opacity = '0';

    setTimeout(() => {
        dom.startOverlay.classList.add('hidden');
        dom.mainUI.style.opacity = '1';
        typeWriter(TEXT, dom.blessing);
    }, 1000);
});

/* =======================
   åˆå§‹åŒ–
======================= */
initThree();
window.addEventListener('resize', onResize);
</script>
</body>
</html>
